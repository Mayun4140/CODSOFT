let quizData = [];
let currentQuestion = 0;
let score = 0;

function addQuestion() {
    // Input values gulo niche
    const qText = document.getElementById("new-question").value;
    const opt0 = document.getElementById("opt0").value;
    const opt1 = document.getElementById("opt1").value;
    const opt2 = document.getElementById("opt2").value;
    const opt3 = document.getElementById("opt3").value;
    const correct = parseInt(document.getElementById("correct-idx").value);

    // Question check kora jate khali na thake
    if (qText === "" || opt0 === "" || opt1 === "") {
        alert("Please fill in the question and at least two options!");
        return;
    }

    // Ekhane data push korte hobe (eta tomar code-e missing chhilo)
    quizData.push({
        question: qText,
        options: [opt0, opt1, opt2, opt3],
        correct: correct
    });

    // Input fields gulo khali kore dewa porer question-er jonno
    document.getElementById("new-question").value = "";
    document.getElementById("opt0").value = "";
    document.getElementById("opt1").value = "";
    document.getElementById("opt2").value = "";
    document.getElementById("opt3").value = "";
    document.getElementById("correct-idx").value = "";

    alert("Question added successfully! Total questions: " + quizData.length);
}

function startQuiz() {
    if (quizData.length === 0) {
        alert("Please add at least one question first!");
        return;
    }
    document.getElementById("creation-section").style.display = "none";
    document.getElementById("quiz-display").style.display = "block";
    loadQuestion();
}

function loadQuestion() {
    const q = quizData[currentQuestion];
    document.getElementById("question-text").innerText = q.question;
    const container = document.getElementById("options-container");
    container.innerHTML = "";

    // Options gulo button hishebe dikhano
    q.options.forEach((option, index) => {
        if(option !== "") { // Jodi option khali na thake
            const button = document.createElement("button");
            button.innerText = option;
            button.onclick = () => checkAnswer(index);
            button.style.display = "block";
            button.style.margin = "10px 0";
            container.appendChild(button);
        }
    });
}

function checkAnswer(selected) {
    if (selected === quizData[currentQuestion].correct) {
        score++;
    }
    currentQuestion++;
    if (currentQuestion < quizData.length) {
        loadQuestion();
    } else {
        showResults();
    }
}

function showResults() {
    document.getElementById("quiz-display").style.display = "none";
    document.getElementById("result-container").style.display = "block";
    document.getElementById("score-text").innerText = "Your Final Score: " + score + " / " + quizData.length;
}
